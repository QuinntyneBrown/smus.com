<!doctype html>
<head>
  <title>Multi-Touch for your Desktop Browser | Boris Smus</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="


In mobile development, it's often easier to start prototyping on the desktop
and then tackle the mobile-specific parts on the devices you intend to support.">

  <!-- Icons -->
  <link rel="icon" type="image/x-icon" href="/static/icons/favicon.ico" />
  <link rel="apple-touch-icon" href="/static/icons/apple-touch-icon.png">

  <!-- Styles -->
  <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:700|PT+Sans|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/static/stylesheets/screen.css" type="text/css" media="screen" charset="utf-8">

  <!-- Feed -->
  <link href="http://feeds.feedburner.com/smuscom" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
  <header>
    <span class="left">
      <a href="/" class="name">Boris Smus</a>
    </span>
    <span class="right">
      <a href="/projects/">Projects</a>
      <a href="/about/">About</a>
      <a href="/archive/posts/">Archives</a>
    </span>
  </header>

  <div id="main">
    <section id="articles">
      
<article>
  <h1><a href="/multi-touch-browser-patch">Multi-Touch for your Desktop Browser</a></h1>
  <div class="subtitle">
  
  <time>Published on 02 May 2011</time>
  
  
  </div>
  <p>
    <p>In mobile development, it's often easier to start prototyping on the desktop
and then tackle the mobile-specific parts on the devices you intend to support.
Multi-touch is one of those features that's difficult to test on the desktop, since
most desktops didn't have multi-touch hardware, and thus desktop browsers don't
have touch event support. Things are different today (you hear every mother say). 
Most new Macs, for example, ship with multi-touch capable input of some sort.
Unfortunately the browsers haven't really caught up yet.</p>

<p>Enter Fajran Iman Rusadi, who released a <a href="https://github.com/fajran/npTuioClient">npTuioClient</a> NPAPI plugin with a
JavaScript wrapper. Unfortunately this library provides a non-standard API to
multi-touch, which is not ideal for developers that want to write their
multi-touch application on desktop and then run the same code on their mobile
devices without modifications.</p>

<h2>Browser Patches</h2>

<p>As HTML5 grows up, browser vendors struggle to stay current up with the growing
variety of specifications. The result is <a href="http://caniuse.com/">uneven feature support</a> across
browsers and a complex problem for web developers.</p>

<p>The web development community has rallied around <strong>shims</strong> and <strong>polyfills</strong>
for the solution. These are bizarre terms that I find confusing and so will
defer to <a href="http://remysharp.com/2010/10/08/what-is-a-polyfill/">Remy Sharp to define</a>. The basic idea of both is to fill in
functionality that's missing in the browser implementation.</p>

<p>Since we now have a well established <a href="https://dvcs.w3.org/hg/webevents/raw-file/tip/touchevents.html">touch events specification</a> working
group at the W3C, I wrote <a href="https://github.com/borismus/MagicTouch">MagicTouch.js</a>, a multi-touch polyfill thatlets
you, the developer, write the same code, test it on your desktop browser and
then, run it on your real device. Totally tubular!</p>

<p>MagicTouch.js still relies on the npTuioClient plugin, it just creates
spec-compatible touch events. Incidentally, here's how you can trigger custom
DOM events:</p>

<pre><code>var event = document.createEvent('CustomEvent');
// Initialize the event, make it bubble up and possible to cancel
event.initEvent('touchstart', true, true);
// Assign properties to the event
event.touches = touchArray;
...
// Get the element associated with the event
var element = document.elementFromPoint(...);
// Assign the element
event.target = element;
// Finally, dispatch the event
element.dispatchEvent(event);
</code></pre>

<p>Note that this approach to create custom DOM events is not cross-browser
compatible. I only tested in Chrome.</p>

<h2>Installation</h2>

<p>Here how to get multi-touch web events working in Chrome for Mac:</p>

<ol>
<li>Download and install the <a href="https://github.com/fajran/npTuioClient#readme">npTuioClient NPAPI plugin</a>
into <code>~/Library/Internet Plug-Ins/</code>.</li>
<li>Download the <a href="https://github.com/fajran/tongseng/downloads">TongSeng TUIO tracker</a> for Macâ€™s MagicPad and start the
server</li>
<li>Download <a href="https://github.com/borismus/MagicTouch">MagicTouch.js</a> and include both the script and the plugin in your
app.</li>
</ol>

<p>The code for this is as follows:</p>

<pre><code>&lt;head&gt;
  ...
  &lt;script src="/path/to/magictouch.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  ...
  &lt;object id="tuio" type="application/x-tuio" style="width:0; height:0;"&gt;
    TUIO Plugin failed to load
  &lt;/object&gt;
&lt;/body&gt;
</code></pre>

<p>...and you're off to the races! Your multi-touch code will now work. Try out
this <a href="https://github.com/borismus/MagicTouch/blob/master/samples/tracker.html">finger tracking demo</a> on either your multi-touch mobile device or your
newly patched desktop browser.</p>

<h2>Future Steps</h2>

<p>As you saw, MagicTouch.js takes some effort to set up initially, requires
you to use an <code>&lt;object&gt;</code> in the HTML, and also needs you to run a separate
process for intercepting touch events. While we can't quite get away without
having to run another process, we can eliminate the NPAPI plugin by using the
<a href="http://dev.w3.org/html5/websockets/">WebSocket API</a> to communicate to that process.</p>

<p>If you're interested in multi-touch mobile web development, check out this
<a href="http://www.html5rocks.com/mobile/touch.html">article on html5rocks.com</a>.</p>

  </p>

  <!--
  DISABLED COMMENTS.

  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'smus'; // Required - Replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  -->
</article>

    </section>
    <aside>
      <img src="/static/images/me.jpg" alt="Headshot of Author" title="Headshot of Author">
      <p>
        I'm Boris Smus, a software engineer and UI prototyper from
        Vancouver, Canada. I currently live in San Francisco and work on
        Chrome related things.
        <a href="/about/" class="readmore"></a>
      </p>
    </aside>
  </div>

  <div id="push"></div>

  <footer>
    <p>
      &copy; 2008 - 2015 Boris Smus<br>
      Powered by <a href="/site/">Lightning</a>
    </p>

    <ul id="social-links">
      <a href="http://feeds.feedburner.com/smuscom" class="social rss" title="RSS" rel="external me">RSS</a>
      <a href="https://github.com/borismus" class="social github" title="GitHub" rel="external me">GitHub</a>
      <a href="https://profiles.google.com/boris.smus" rel="author" class="social plus" title="Google Plus" rel="external me">Google Plus</a>
      <a href="https://twitter.com/borismus" class="social twitter" title="Twitter" rel="external me">Twitter</a>
    </ul>
  </footer>


  <script src="/static/javascripts/highlight.pack.js"></script>
  <script>
    // Syntax highlighting for code.
    hljs.tabReplace = '  ';
    hljs.initHighlightingOnLoad();
  </script>
  <script>
    // Google Analytics.
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-17930798-22', 'smus.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>
  <script src="//cdn.webglstats.com/stat.js" defer="defer" async="async"></script>
  <script src="/lightning_error.js"></script>
</body>