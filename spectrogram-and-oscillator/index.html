<!doctype html>
<head>
  <title>Spectrogram and Oscillator | Boris Smus</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="A live-input spectrogram written using [Polymer][polymer] using the [Web
Audio API][wapi].">

  <!-- Icons -->
  <link rel="icon" type="image/x-icon" href="/static/icons/favicon.ico" />
  <link rel="apple-touch-icon" href="/static/icons/apple-touch-icon.png">

  <!-- Styles -->
  <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:700|PT+Sans|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/static/stylesheets/screen.css" type="text/css" media="screen" charset="utf-8">

  <!-- Feed -->
  <link href="http://feeds.feedburner.com/smuscom" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
  <header>
    <span class="left">
      <a href="/" class="name">Boris Smus</a>
    </span>
    <span class="right">
      <a href="/projects/">Projects</a>
      <a href="/about/">About</a>
      <a href="/archive/posts/">Archives</a>
    </span>
  </header>

  <div id="main">
    <section id="articles">
      
<article>
  <h1><a href="/spectrogram-and-oscillator">Spectrogram and Oscillator</a></h1>
  <div class="subtitle">
  
  <time>Published on 09 June 2014</time>
  
  
  </div>
  <p>
    <p>A live-input spectrogram written using <a href="http://polymer-project.org">Polymer</a> using the <a href="http://webaudioapi.com">Web
Audio API</a>.</p>

<p><img src="screenshot.png" alt="Screenshot of spectrogram" /></p>

<p>If you're running Chrome or Firefox, <a href="http://borismus.github.io/spectrogram">see it in action</a>. Once the
spectrogram is running, see if you can make a pattern with your speech
or by whistling. You can also click anywhere on the page to turn on the
oscillator. For a mind-blowing effect, <a href="https://www.youtube.com/watch?v=M9xMuPWAZW8&amp;t=5m30s">load this</a> in a parallel
tab.</p>

<!--more-->

<h2>Why?</h2>

<p>Having a spectrogram is incredibly handy for a lot of the work I've been
doing recently. So a while ago, I built one that satisfies my needs. It
runs in a full-screen, using the microphone input as the source.</p>

<p>It also includes an oscillator, which plays a sine wave at the frequency
of your pointer. It also shows you the frequency that it plays back, and
plots a short buffer of pointer positions. This is handy for measuring
internal latency:</p>

<p><img src="latency.png" alt="Latency estimation" /></p>

<p>Having the oscillator built-in is also pretty fun. You can <a href="sounds/morse.wav">send morse
code</a> (short short short, long long, short short long, short
short short), <a href="sounds/radio.wav">scan for radio stations</a>, make 8-bit character
<a href="sounds/sfx.wav">dying sound effects</a>, simulate <a href="sounds/ghosts.wav">aliens, ghosts and
theremins</a>, and annoy <a href="sounds/dogs.wav">small, annoying dogs</a>.</p>

<p>I use the tool mostly in Chrome, but it also works in Firefox.
Unfortunately no other browser currently has both <code>getUserMedia</code> and Web
Audio API support.</p>

<h2>Configuration parameters</h2>

<p>The following are HTML attributes of the <code>g-spectrogram</code> component. Many
of them are also configurable via the spectrogram controls component,
which shows up if the <code>controls</code> attribute is set to true.</p>

<ul>
<li><code>controls</code> (boolean): shows a config UI component.</li>
<li><code>log</code> (boolean): enables y-log scale (linear by default).</li>
<li><code>speed</code> (number): how many pixels to move past for every frame.</li>
<li><code>labels</code> (boolean): enables y-axis labels.</li>
<li><code>ticks</code> (number): how many y labels to show.</li>
<li><code>color</code> (boolean): turns on color mode (grayscale by default).</li>
<li><code>oscillator</code> (boolean): enables an oscillator overlay component. When
you click anywhere in the spectrogram, a sine wave plays corresponding
to the frequency you click on.</li>
</ul>

<h2>Using the Polymer component</h2>

<p>If you are inclined to embed this component somewhere, you can,
since it's implemented in Polymer, which, by the way, is an
awesome framework. Once you've <a href="http://www.polymer-project.org/docs/start/getting-the-code.html">gotten started</a>, here's
the simplest possible version:</p>

<pre><code>&lt;g-spectrogram/&gt;
</code></pre>

<p>Enable controls:</p>

<pre><code>&lt;g-spectrogram controls&gt;&lt;/g-spectrogram&gt;
</code></pre>

<p>Pass parameters to the component:</p>

<pre><code>&lt;g-spectrogram log labels ticks="10"&gt;&lt;/g-spectrogram&gt;
</code></pre>

<h2>Future work ideas</h2>

<p>It would be great to add a few things to this tool. If you're interested
in helping, submit your changes as a pull request <a href="https://github.com/borismus/spectrogram">on github</a>.
Some ideas for things that can be done:</p>

<ul>
<li>Improved axis labeling.</li>
<li>Make it work in mobile browsers.</li>
<li>Loading/saving of traces.</li>
<li>Loading audio data from a file.</li>
<li>Zoom support.</li>
<li>Higher precision FFT results (would require writing a custom FFT
rather than using the one built into Web Audio API.)</li>
</ul>

  </p>

  <!--
  DISABLED COMMENTS.

  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'smus'; // Required - Replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  -->
</article>

    </section>
    <aside>
      <img src="/static/images/me.jpg" alt="Headshot of Author" title="Headshot of Author">
      <p>
        I'm Boris Smus, a software engineer and UI prototyper from
        Vancouver, Canada. I currently live in San Francisco and work on
        Chrome related things.
        <a href="/about/" class="readmore"></a>
      </p>
    </aside>
  </div>

  <div id="push"></div>

  <footer>
    <p>
      &copy; 2008 - 2015 Boris Smus<br>
      Powered by <a href="/site/">Lightning</a>
    </p>

    <ul id="social-links">
      <a href="http://feeds.feedburner.com/smuscom" class="social rss" title="RSS" rel="external me">RSS</a>
      <a href="https://github.com/borismus" class="social github" title="GitHub" rel="external me">GitHub</a>
      <a href="https://profiles.google.com/boris.smus" rel="author" class="social plus" title="Google Plus" rel="external me">Google Plus</a>
      <a href="https://twitter.com/borismus" class="social twitter" title="Twitter" rel="external me">Twitter</a>
    </ul>
  </footer>


  <script src="/static/javascripts/highlight.pack.js"></script>
  <script>
    // Syntax highlighting for code.
    hljs.tabReplace = '  ';
    hljs.initHighlightingOnLoad();
  </script>
  <script>
    // Google Analytics.
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-17930798-22', 'smus.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>
  <script src="//cdn.webglstats.com/stat.js" defer="defer" async="async"></script>
  <script src="/lightning_error.js"></script>
</body>