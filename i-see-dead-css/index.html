<!doctype html>
<head>
  <title>I See Dead CSS | Boris Smus</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="

I wanted a tool that would analyze a complete web site, and report what
CSS selectors and IDs are dead.">

  <!-- Icons -->
  <link rel="icon" type="image/x-icon" href="/static/icons/favicon.ico" />
  <link rel="apple-touch-icon" href="/static/icons/apple-touch-icon.png">

  <!-- Styles -->
  <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:700|PT+Sans|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/static/stylesheets/screen.css" type="text/css" media="screen" charset="utf-8">

  <!-- Feed -->
  <link href="http://feeds.feedburner.com/smuscom" rel="alternate" title="Boris Smus" type="application/atom+xml"/>
</head>
<body>
  <header>
    <span class="left">
      <a href="/" class="name">Boris Smus</a>
    </span>
    <span class="right">
      <a href="/projects/">Projects</a>
      <a href="/about/">About</a>
      <a href="/archive/posts/">Archives</a>
    </span>
  </header>

  <div id="main">
    <section id="articles">
      
<article>
  <h1><a href="/i-see-dead-css">I See Dead CSS</a></h1>
  <div class="subtitle">
  
  <time>Published on 11 December 2008</time>
  
  
  </div>
  <p>
    <p>I wanted a tool that would analyze a complete web site, and report what
CSS selectors and IDs are dead. By dead, I mean one of two things --
either the ID or selector is referenced from the HTML and undefined in
the CSS or it is defined in the CSS but never referenced in the HTML.</p>

<p>A search for some CSS finding utilities proved somewhat fruitful. I
found a brief <a href="http://www.aggiorno.com/blogs/aggiornings/post/Detecting-unused-CSS-selectors-.aspx">survey of related utilities</a> for this finding or
cleaning dead CSS, the most promising of which was a Firefox plug-in
called <a href="http://www.sitepoint.com/dustmeselectors/">Dust-Me Selectors</a>. But I wanted something that could be
integrated into an automatic build process, easily invokable from the
command line without requiring a browser, so I started thinking about a
custom solution.</p>

<p>The problem can be solved as follows:</p>

<ol>
<li>Find all referenced IDs and classes, called R</li>
<li>Find all defined IDs and classes, called D</li>
<li>Take a difference between the sets so that the list of undefined IDs
and classes is (R - D), and the list of unreferenced IDs and classes
is (D - R)</li>
</ol>

<p>I've already had the pleasure of using <a href="http://www.crummy.com/software/BeautifulSoup/">BeautifulSoup</a> python library
to parse all sorts of HTML documents, and I quickly found <a href="http://cthedot.de/cssutils/">cssutils</a>
to be a very handy CSS parser. In a matter of hours I was able to whip
up a basic dead CSS finder in 100 lines of code using these great tools.
I named it 7sense, after <a href="http://www.imdb.com/title/tt0167404/">the movie</a>. To run it, you just need to
invoke <code>./7sense.py &lt;list of files and directories&gt;</code> and the specified
files will be parsed as if they were all part of the same webpage.
Directories will be walked recursively, with all encountered CSS and
HTML files assumed to be part of the web page.</p>

<p>But things are not as simple as I had hoped, and my program has several
notable limitations.</p>

<ol>
<li>Due to lack of time, 7sense does not look at what stylesheets are
referenced by an HTML page. Instead, you have to tell it explicitly
what stylesheets are used by passing them as arguments.</li>
<li>7sense does not properly decipher heirarchical CSS selectors like
'#myContainer .aboutBox'. Instead, it splits the selector into
whitespace separated tokens, ignoring their structure. I skimped on
this feature also due to lack of time.</li>
<li>More fundamentally, 7sense is not aware of any Javascript
modifications to the DOM. This could be remedied on a case-by-case
basis. For example, one could write a parser to seek jQuery.setClass
invocations, and extract additional classes from there.</li>
</ol>

<p>At any rate, here's <a href="http://www.borismus.com/wp-content/uploads/2008/12/7sense.py">7sense so far</a>. Though flawed, it's a useful
start. Ideas and code improvements, especially addressing the above
limitations are very much appreciated!</p>

  </p>

  <!--
  DISABLED COMMENTS.

  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'smus'; // Required - Replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  -->
</article>

    </section>
    <aside>
      <img src="/static/images/me.jpg" alt="Headshot of Author" title="Headshot of Author">
      <p>
        I'm Boris Smus, a software engineer and UI prototyper from
        Vancouver, Canada. I currently live in San Francisco and work on
        Chrome related things.
        <a href="/about/" class="readmore"></a>
      </p>
    </aside>
  </div>

  <div id="push"></div>

  <footer>
    <p>
      &copy; 2008 - 2015 Boris Smus<br>
      Powered by <a href="/site/">Lightning</a>
    </p>

    <ul id="social-links">
      <a href="http://feeds.feedburner.com/smuscom" class="social rss" title="RSS" rel="external me">RSS</a>
      <a href="https://github.com/borismus" class="social github" title="GitHub" rel="external me">GitHub</a>
      <a href="https://profiles.google.com/boris.smus" rel="author" class="social plus" title="Google Plus" rel="external me">Google Plus</a>
      <a href="https://twitter.com/borismus" class="social twitter" title="Twitter" rel="external me">Twitter</a>
    </ul>
  </footer>


  <script src="/static/javascripts/highlight.pack.js"></script>
  <script>
    // Syntax highlighting for code.
    hljs.tabReplace = '  ';
    hljs.initHighlightingOnLoad();
  </script>
  <script>
    // Google Analytics.
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-17930798-22', 'smus.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>
  <script src="//cdn.webglstats.com/stat.js" defer="defer" async="async"></script>
  <script src="/lightning_error.js"></script>
</body>